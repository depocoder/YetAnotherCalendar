# üóìÔ∏è YetAnotherCalendar

[![Python](https://img.shields.io/badge/python-3.12.8+-blue.svg?style=flat&logo=python&logoColor=white)](https://www.python.org/downloads/)
[![Linting: Ruff](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/charliermarsh/ruff/main/assets/badge/v2.json)](https://github.com/astral-sh/ruff)
[![Checked with mypy](https://www.mypy-lang.org/static/mypy_badge.svg)](https://mypy-lang.org/)
[![uv](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/uv/main/assets/badge/v0.json)](https://github.com/astral-sh/uv)

<!-- Pytest Coverage Comment:Begin -->
<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/README.md"><img alt="Coverage" src="https://img.shields.io/badge/Coverage-86%25-green.svg" /></a><details><summary>Coverage Report </summary><table><tr><th>File</th><th>Stmts</th><th>Miss</th><th>Cover</th><th>Missing</th></tr><tbody><tr><td colspan="5"><b>yet_another_calendar/web</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/application.py">application.py</a></td><td>66</td><td>21</td><td>68%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/application.py#L27-L31">27&ndash;31</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/application.py#L34-L48">34&ndash;48</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/application.py#L69-L70">69&ndash;70</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/application.py#L95">95</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/application.py#L100">100</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/cache_builder.py">cache_builder.py</a></td><td>8</td><td>2</td><td>75%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/cache_builder.py#L18-L21">18&ndash;21</a></td></tr><tr><td colspan="5"><b>yet_another_calendar/web/api/bulk</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py">integration.py</a></td><td>84</td><td>30</td><td>64%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py#L48">48</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py#L56">56</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py#L70-L73">70&ndash;73</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py#L87-L110">87&ndash;110</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py#L123-L131">123&ndash;131</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/integration.py#L151">151</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/schema.py">schema.py</a></td><td>45</td><td>5</td><td>89%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/schema.py#L15">15</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/schema.py#L29-L30">29&ndash;30</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/schema.py#L45-L46">45&ndash;46</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/views.py">views.py</a></td><td>25</td><td>8</td><td>68%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/views.py#L33-L40">33&ndash;40</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/views.py#L55">55</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/bulk/views.py#L74-L79">74&ndash;79</a></td></tr><tr><td colspan="5"><b>yet_another_calendar/web/api/docs</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/docs/views.py">views.py</a></td><td>15</td><td>5</td><td>67%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/docs/views.py#L20-L21">20&ndash;21</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/docs/views.py#L37">37</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/docs/views.py#L48-L49">48&ndash;49</a></td></tr><tr><td colspan="5"><b>yet_another_calendar/web/api/lms</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/integration.py">integration.py</a></td><td>65</td><td>14</td><td>78%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/integration.py#L18">18</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/integration.py#L119-L131">119&ndash;131</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/schema.py">schema.py</a></td><td>84</td><td>16</td><td>81%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/schema.py#L46">46</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/schema.py#L105-L126">105&ndash;126</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/views.py">views.py</a></td><td>17</td><td>4</td><td>76%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/views.py#L18">18</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/views.py#L28">28</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/views.py#L39">39</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/lms/views.py#L50">50</a></td></tr><tr><td colspan="5"><b>yet_another_calendar/web/api/modeus</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/integration.py">integration.py</a></td><td>99</td><td>24</td><td>76%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/integration.py#L44">44</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/integration.py#L82-L113">82&ndash;113</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/integration.py#L172-L184">172&ndash;184</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/integration.py#L205">205</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py">schema.py</a></td><td>205</td><td>22</td><td>89%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L27">27</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L48">48</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L50">50</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L61">61</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L63">63</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L68">68</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L84">84</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L104">104</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L208-L211">208&ndash;211</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L218">218</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L257-L258">257&ndash;258</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L266-L270">266&ndash;270</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L276">276</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/schema.py#L283">283</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/views.py">views.py</a></td><td>22</td><td>7</td><td>68%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/views.py#L25-L28">25&ndash;28</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/views.py#L39">39</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/views.py#L49">49</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/modeus/views.py#L62-L64">62&ndash;64</a></td></tr><tr><td colspan="5"><b>yet_another_calendar/web/api/netology</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/integration.py">integration.py</a></td><td>57</td><td>9</td><td>84%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/integration.py#L65-L69">65&ndash;69</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/integration.py#L73-L79">73&ndash;79</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/schema.py">schema.py</a></td><td>137</td><td>2</td><td>99%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/schema.py#L30">30</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/schema.py#L107">107</a></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/views.py">views.py</a></td><td>18</td><td>4</td><td>78%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/views.py#L23">23</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/views.py#L36">36</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/views.py#L46">46</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/netology/views.py#L57">57</a></td></tr><tr><td colspan="5"><b>yet_another_calendar/web/api/utmn</b></td></tr><tr><td>&nbsp; &nbsp;<a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/utmn/integration.py">integration.py</a></td><td>54</td><td>3</td><td>94%</td><td><a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/utmn/integration.py#L40">40</a>, <a href="https://github.com/depocoder/YetAnotherCalendar/blob/main/yet_another_calendar/web/api/utmn/integration.py#L81-L82">81&ndash;82</a></td></tr><tr><td><b>TOTAL</b></td><td><b>1223</b></td><td><b>176</b></td><td><b>86%</b></td><td>&nbsp;</td></tr></tbody></table></details>
<!-- Pytest Coverage Comment:End -->

[![Redis](https://img.shields.io/badge/redis-%23DD0031.svg?style=for-the-badge&logo=redis&logoColor=white&style=flat)](https://redis.io/)
[![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white&style=flat)](https://www.docker.com/)
[![FastAPI](https://img.shields.io/badge/FastAPI-005571?style=for-the-badge&logo=fastapi&style=flat)](https://fastapi.tiangolo.com/)
[![Pydantic v2](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/pydantic/pydantic/main/docs/badge/v2.json)](https://docs.pydantic.dev/latest/contributing/#badges)

## üìù Overview

YetAnotherCalendar was created to provide a superior alternative to Modeus/Netology calendars with enhanced features and
better user experience. It combines multiple educational platforms into a single, convenient calendar interface.

## ‚ú® Features

* üì± **Responsive Interface** - Works seamlessly on all devices
* üîÑ **Export to ICS** - Sync with Google Calendar, Apple Calendar, and more
* üåç **Timezone Support** - Automatic timezone handling (default Moscow)
* üîå **Multi-Platform Integration** - Modeus + Netology + LMS unified
* üì¶ **Redis Caching** - Lightning-fast performance with smart caching (14-day retention)
* üè∑Ô∏è **Event Management** - Custom tagging and categorization with source attribution
* üîç **Advanced Search** - Powerful filtering and search capabilities
* üîí **Enterprise Security** - Rate limiting, JWT tokens, and brute force protection
* üë®‚Äçüè´ **Admin Panel** - Secure tutor authentication with donor account system
* üöÄ **High Performance** - Async Python with optimized database queries
* üìä **Production Monitoring** - Rollbar error tracking with sensitive data scrubbing
* üîó **MTS Link Management** - Custom webinar redirect system with Redis storage
* üõ°Ô∏è **Security Hardening** - Comprehensive field scrubbing for all authentication tokens

## üöÄ Getting Started

### Prerequisites

- Python 3.12.8+
- Docker and Docker Compose (optional)

### Installation

#### 1. Using uv (Recommended)

[uv](https://github.com/astral-sh/uv) is a fast Python package installer and resolver.

```bash
# On macOS and Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Clone the repository
git clone https://github.com/depocoder/YetAnotherCalendar.git
cd YetAnotherCalendar

# Install dependencies
uv sync

# Create environment file
cp .env.dist .env
# Edit .env with your configuration (see Environment Variables section below)

# install pre-commit hooks
uv run pre-commit install

# Run the application
uv run python -m yet_another_calendar
```

#### 2. Using Docker Compose

```bash
# Clone the repository
git clone https://github.com/depocoder/YetAnotherCalendar.git
cd YetAnotherCalendar

# Create environment file
cp .env.dist .env
# Edit .env with your configuration (see Environment Variables section below)

# Start the services
docker compose up --build -d
```

## üîß Environment Variables

Configure your application by setting these environment variables in your `.env` file:

### üèóÔ∏è **Core Settings**
```bash
YET_ANOTHER_CALENDAR_WORKERS_COUNT=10          # üîÑ Number of uvicorn workers
YET_ANOTHER_CALENDAR_DEBUG=False               # üêõ Enable debug mode
```

### üîê **Security & Authentication**
```bash
# Tutor Admin Panel Authentication
YET_ANOTHER_CALENDAR_TUTOR_PASSWORD_HASH=""            # üîí Hashed password for admin access
YET_ANOTHER_CALENDAR_TUTOR_SECRET_KEY=""               # üîë JWT secret key for tutor tokens

# Modeus Donor Account (for tutors to access student schedules)
YET_ANOTHER_CALENDAR_MODEUS_USERNAME=""                # üë§ Modeus donor account username
YET_ANOTHER_CALENDAR_MODEUS_PASSWORD=""                # üîê Modeus donor account password
```

### üõ°Ô∏è **Rate Limiting Protection**
```bash
YET_ANOTHER_CALENDAR_LOGIN_MAX_ATTEMPTS=5              # üö´ Max failed login attempts
YET_ANOTHER_CALENDAR_LOGIN_LOCKOUT_TIME=900            # ‚è±Ô∏è Lockout time in seconds (15 min)
```

### üåê **External Services**
```bash
# Netology Integration
NETOLOGY_DEFAULT_COURSE_ID=45526                       # üìö Default course ID
NETOLOGY_COURSE_NAME="–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ IT-–ø—Ä–æ–¥—É–∫—Ç–æ–≤"         # üìñ Course name
NETOLOGY_URL="https://netology.ru"                     # üîó Netology base URL

# Application Domain
YET_ANOTHER_CALENDAR_APP_DOMAIN="https://yetanothercalendar.ru"  # üåç Your domain
```

### üõ°Ô∏è **Error Monitoring & Logging**
```bash
# Rollbar Integration (Production Error Tracking)
YET_ANOTHER_CALENDAR_ROLLBAR_TOKEN=""                  # üîç Rollbar access token  
YET_ANOTHER_CALENDAR_ROLLBAR_ENVIRONMENT="production"   # üè∑Ô∏è Environment (dev/staging/production)
```

### ‚öôÔ∏è **Generate Password Hash**
To set up admin access, run this script to generate a secure password hash:

```bash
cd backend
python generate_password_hash.py
```

Copy the generated hash to your `.env` file as `YET_ANOTHER_CALENDAR_TUTOR_PASSWORD_HASH`.

## üêõ Debugging

### Python Debug with VS Code

The application includes debugpy integration for remote debugging during development.

#### Setup & Usage

1. **Start the application in debug mode**:
   ```bash
   # Set debug mode in .env
   YET_ANOTHER_CALENDAR_DEBUG=True
   
   # Using Docker Compose (recommended)
   docker compose up --build
   
2. **In VS Code**:
   - Open the project folder containing `.vscode/launch.json`
   - Go to Run and Debug (Ctrl+Shift+D)
   - Select "Python debug backend" configuration
   - Click "Start Debugging" (F5)

#### Configuration Details

- **Debug Port**: 5678 (automatically exposed in Docker)
- **Path Mapping**: 
  - Local: `${workspaceFolder}/backend` 
  - Remote: `/app/src` (inside Docker container)
- **Connection**: Attaches to running application (not launch mode)

#### When Debug Mode is Active

- Debugpy listens on `0.0.0.0:5678` inside the container
- Port 5678 is exposed via Docker Compose
- VS Code can attach and set breakpoints in your backend code
- `justMyCode: true` - only debug your application code (not libraries)

#### Troubleshooting

- Ensure `YET_ANOTHER_CALENDAR_DEBUG=True` in your `.env` file
- Check that port 5678 is not used by another process
- Restart the Docker container after changing debug settings
- Verify VS Code is using the correct launch configuration

## üìñ Documentation

### üìä **API Documentation**

Once the application is running, you can access the interactive API documentation:

- üéØ **Swagger UI**: [http://localhost:8000/api/docs](http://localhost:8000/api/docs)
- üìö **ReDoc**: [http://localhost:8000/api/redoc](http://localhost:8000/api/redoc)

![Swagger](https://github.com/user-attachments/assets/bca25df5-fd1a-4942-adb8-72f3f18ab178)

### üë®‚Äçüè´ **Admin Panel Access**

After setting up your tutor password, access the admin panel at:
- üîê **Admin Login**: [http://localhost:3000/admin/login](http://localhost:3000/admin/login)
- üìÖ **Calendar Links**: [http://localhost:3000/admin/calendar-links](http://localhost:3000/admin/calendar-links)

## üôè Acknowledgements

- [FastAPI](https://fastapi.tiangolo.com/)
- [Pydantic](https://pydantic-docs.helpmanual.io/)
- [React](https://reactjs.org/)
- [Redis](https://redis.io/)

